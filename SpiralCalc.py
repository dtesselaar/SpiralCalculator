import tkinter as tk
from tkinter import ttk
from tempfile import mkstemp

__version_info__ = ('1','1','0')
__version__ = '.'.join(__version_info__)


def main():
    root = tk.Tk()
    mainGUI = MainGUI(root)

    root.mainloop()

class MainGUI():
    def __init__(self, parent):

        self.parent = parent
        self.parent.title("Spiral Parameter Calculator")
        self.parent.iconbitmap(self.icon())

        self.frm = {}
        self.lbl = {}
        self.btn = {}
        self.ent = {}
        self.dropdown = {}
        self.tkvar ={}




        #### Banner ####
        self.lbl['banner'] = tk.Label(self.parent, font=(None, 10), bg="#42E2B8")
        self.lbl['banner'].grid(column=0, row=0, sticky=('E','W'), columnspan=2)




        #### Inputs Frame ####
        self.inputs_enum = {
            "Revolutions":"5",
            "Diameter (L or W)":"10",
            'Exclusion Radius':"0",
            'x Rotation':["0","180"],
            'y Rotation':["0","180"],
            'z Rotation':"0",
            'Reverse':["False","True"]
        }

        self.frm["inputs"] = tk.LabelFrame(self.parent, text="Software A Parameters", padx=10, pady=10)

        for name, var in self.inputs_enum.items():
            self.lbl[name]   = tk.Label(self.frm["inputs"] , text=name)

            if (name != 'x Rotation') and (name != 'y Rotation') and (name != 'Reverse'):
                self.tkvar[name] = tk.StringVar()
                self.ent[name]   = tk.Entry(self.frm["inputs"], textvariable=self.tkvar[name])
                self.tkvar[name].set(var)
            else:
                self.dropdown[name] = ttk.Combobox(self.frm["inputs"], values=var, state="readonly", width=17)


        self.frm["inputs"].grid(column=0, row=1, padx=10, pady=10)
        idx=0
        for name in self.inputs_enum.keys():

            self.lbl[name].grid(column=0, row=idx, pady=1)

            if (name != 'x Rotation') and (name != 'y Rotation') and (name != 'Reverse'):
                self.ent[name].grid(column=1, row=idx, pady=1)
            else:
                self.dropdown[name].grid(column=1, row=idx, pady=1)
                self.dropdown[name].current(0)
            idx+=1




        #### Outputs Frame ####
        self.outputs_enum = [
            "a (um/rad)",
            "Start Angle (degrees)",
            "End Angle (degrees)",
            "Rotation (degrees)"
        ]

        self.frm["outputs"] = tk.LabelFrame(self.parent, text="Software B Parameters", padx=10, pady=10)

        for name in self.outputs_enum:
            self.tkvar[name] = tk.StringVar()
            self.lbl[name]   = tk.Label(self.frm["outputs"], text=name)
            self.ent[name]   = tk.Entry(self.frm["outputs"], textvariable=self.tkvar[name], state='readonly')

        self.frm["outputs"].grid(column=1, row=1, padx=10)
        idx=0
        for name in self.outputs_enum:
            self.lbl[name].grid(column=0, row=idx)
            self.ent[name].grid(column=1, row=idx)
            idx+=1


        #### Button Frame 3 #####
        self.frm['calculate frame'] = tk.Frame(self.parent)
        self.frm['calculate frame'].grid(column=0, row=2, columnspan=2)

        self.btn['calc btn'] = tk.Button(self.frm['calculate frame'], text="Calculate", command=self.calculate, padx=40, pady=12)
        self.btn['calc btn'].grid(column=0, row=0, pady=10)


        #### Version ####
        self.lbl['version'] = tk.Label(self.parent, text="Version " + __version__, font=(None, 8), padx=5, pady=5)
        self.lbl['version'].grid(column=1, row=3, sticky=('E'))


        #### Key bindings  ####
        self.parent.bind('<Escape>', self.close)


    def close(self, *args, **kwargs):
        self.parent.destroy()


    def bannerError(self, message):
        self.lbl['banner'].config(bg="#EB8A90", text=message, font='TkDefaultFont 10 bold')

    def UIOK(self):
        self.lbl['banner'].config(bg="#42E2B8", text="")

        for name in self.inputs_enum.keys():
            self.lbl[name].config(fg='black')

    def calculate(self):
        ERROR=False

        try:
            revolutions =       float(self.tkvar["Revolutions"].get())
            diameter =          float(self.tkvar["Diameter (L or W)"].get())
            exclusion_radius =  float(self.tkvar["Exclusion Radius"].get())
            rotation_x =        float(self.dropdown["x Rotation"].get())
            rotation_y =        float(self.dropdown["y Rotation"].get())
            rotation_z =        float(self.tkvar["z Rotation"].get())
            reverse =           (self.dropdown["Reverse"].get() == "True")

            if diameter <= 0:
                ERROR=True
                message="Diameter (L or W) must be greater than 0 um"
                self.bannerError(message=message)
                self.lbl['Diameter (L or W)'].config(fg='red')
                return
            elif revolutions <= 0:
                ERROR=True
                message="The number of revolutions must be greater than 0."
                self.bannerError(message=message)
                self.lbl['Revolutions'].config(fg='red')
                return
            elif exclusion_radius >= diameter/2:
                ERROR=True
                message="The Exclusion Radius can not be larger than the radius of the spiral."
                self.bannerError(message=message)
                self.lbl['Exclusion Radius'].config(fg='red')
                return
            elif exclusion_radius < 0:
                ERROR=True
                message="The Exclusion Radius can not be larger than the radius cannot be less than zero."
                self.bannerError(message=message)
                self.lbl['Reverse'].config(fg='red')
                return
        except:
            ERROR=True
            message="Software A parameters were not formatted correctly."
            self.bannerError(message=message)
            return

        if not ERROR:
            self.UIOK()

        a = self.get_a(revolutions, diameter)
        start_angle, end_angle = self.get_angles(a, revolutions, exclusion_radius, reverse, rotation_x, rotation_y)
        rotation = self.get_rotation(rotation_y, rotation_z)

        start_angle = str(start_angle)
        end_angle = str(end_angle)
        rotation= str(rotation)
        if start_angle == "-0.0":
            start_angle = "0.0"
        elif end_angle == "-0.0":
            end_angle = "0.0"
        elif rotation == "-0.0":
            rotation = "0.0"

        self.tkvar['a (um/rad)'].set(str(a))
        self.tkvar['Start Angle (degrees)'].set(start_angle)
        self.tkvar['End Angle (degrees)'].set(end_angle)
        self.tkvar['Rotation (degrees)'].set(rotation)

    def degrees(self,theta):
        tau = 6.28318530718   # tau is better than pie. prove me wrong.
        return 360*theta/tau

    def get_a(self, revolutions, length):
        pi = 3.14159265359
        return length/(4*pi*revolutions)

    def get_angles(self, a, revolutions, exclusion_radius, reverse, rotation_x, rotation_y):
        start_angle = -revolutions*360
        end_angle = self.degrees(-exclusion_radius/a)

        # rotations in x and y of 180 degrees change the spiral from CW to CCW. This corresponds to a multiplication of -1 in OmniWELD.
        if rotation_x==180 and rotation_y==0:
            start_angle*=-1
            end_angle*=-1
        elif rotation_x==0 and rotation_y==180:
            start_angle*=-1
            end_angle*=-1

        #return angles
        if reverse==False:
            ldd_angles = [start_angle, end_angle]
            return ldd_angles

        elif reverse==True:
            ldd_angles = [end_angle, start_angle]
            return ldd_angles

    def get_rotation(self, rotation_y, rotation_z):

        rotation = 180 + rotation_z + rotation_y

        return rotation

    def icon(self):
        """This is a horrific but effictive workaround to storing the .ico file somewhere on disk."""

        icodat = b'\x00\x00\x01\x00\x01\x00\x00\x00\x00\x00\x01\x00 \x00\xed\x13\x00\x00\x16\x00\x00\x00\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x01\x00\x00\x00\x01\x00\x08\x02\x00\x00\x00\xd3\x10?1\x00\x00\x13\xb4IDATx\xda\xed\x9d\xfb\x93]U\x99\x86\xdf\xee\x84&!@0\x18\xee\x91\x92\xa8\x83f\xd4\t\x08\xa3\x88#\x03ap\x04\x11%\xa4\x00\x81\x91\x00I\xc8\x05\x08bY5U\xf3\xa3US#h\xa0I\x02\x81@(\xaeV\x82\x8a\xca-I\xdf\x92\xee\xa4IH\xfav\xce\xe9\xfb\xfd~\xce\xde\xfb\x9c}\xee\xfb\xba\xe6\x07\xff\x01\x17\xf6\xe5\xacu\xde\xe7\x0f\xe8\xde\xefZ\xdfS\xb5\xeb|{}\xabB\xfc\xfa\x02\x10\xadqQ\xf5k\xfcO=nP>H\xc6\x1coz\'p\xf23\xf87+Y\x1fz#P\xf1!\xfe\xf3(\xaeW>H\xe0\':jf\xb6\xfa)\x80\xfe\x0c\xe0\x8a}X\x1f`\xa1\xeaAR\x83\xa7\x0b\x89\xe1\x19\xff\xb3\x14@g\x8aXT\x8d\xc7,,S=\x88\x93\x9aJv7\xcf\xc6_\xa6\x00:s\x00w\xb5b\xb5\xea)B\xcfI\xb4\x1f\x0e}\x87\x02\x10\tb\xf8\xdak\xf8\xb9@\x85\xda1\x84\xb0z\x8e\x17\x93S\xb3\xf4\xe7)\x80\x9e\xa4\xb1\xf4i\xfc\xd2E\x95\xeaAr\xd3\x03\xf6`+ (\x00\xf9{\t\xb0`\x1f\x1e\x1c\xc0J\xd5\x83\xf8\x85\xb4\x19k\x10\x817{\xff\x82\x02hH\x13\xbe\xfb>nU\xfd\xe5G\x84\x81\xd9\xd5\xe4f\xccY\xfd/\x14@7\xa6q\xe1\x1el*b\x91\xeaA\xb2\x13\xdd\xd9\xd1\xd8l\xff\x17\n\xa0\x15\x1e\xce\xd8\x83\x8d\xa3X\xa1z\x10?\x9f6:j\x85\x08)\x00\x91\xe0 n\xa9\xc1\x1a\xd5S\x880\x88\xb7}\x1c\xb8\x859\xf8_\x14@\x1fF\xf1\x85\x17\xb1I\xf9\xdf=\x01{\xe0t~\x16\x9a\xbe\x14@g\\T\xfd\x16O\xdaX\xaaz\x90br"\xd9\xfb\t\x84\x98\x9b\x7fG\x014a?\xd6i\xd0\xf4\r\xbc\xa2\x19m\x98\x9b\x97\x1f\n\xa0\x0fQ\xacz\x1b\xf7\x86\xaa\xef\xa6\x10\xa9\xde\x13\x05s|.\xff\'\x05P\x9e\x14\xce{\x16\xdb38G\xf5 \xf9\xc4Pj\xe0\xd4\xec5})\x80\x86\x04X\xf0&\xee\xef\xc6?)\x1f\xc4\xc9%:jE\xe0\xcf\xf1\xff\xa5\x00j\xd3\x8co\xff\x19\xb7+\x1fC\x08#v\xc4\xcbZs\xff\x9f)\x80\xc2\x18X\xbe\x0b[5h\xfaf\xc6\xbb\xe6\xa0\xe9K\x01\xb4B\xa0b7\x1e\x1d\xc3e\xaa\x07\xf1\xf2\xb6\x19k\x98\x83\xa6/\x05\xd0\x8a\x83\xf8\x0f\x1d\x9a\xbe\x81ot\xd4\xf8\x85\xcc|=\x00\x05P\x92\x11|a7\xb6hp\xd8\xc5\x1ej\xcdO\x0f\xce\xe3#P\x00\xf5(`\xf1\xf3\xd8\x96\xc4\xe7T\x0fRLM%{\x9a\xe7\xeb\xe5\x87\x02(\x89@\xc5\x1f\xf1\xd3Oq\x8d\xeaAB\xcf1\xa3\xf5s\xd9\xf4\xa5\x00:\x10\xc3\xaawpO\x80\x05\xaa\x8b\x9c\xec;9\xc7M_\n\xa0<\x19\x9c\xf3<\xb6j\xf0\xc5[\xc1\x1cK\xf5\x9d\x98\xe3\xa6/\x05P\x9b\x10\x95\xaf\xe3\x81\x18V\xa9\x1e$p\x0b\xf1\x96\x8fE\x18\x94\xc2\xc3P\x00e8\x89k\xfe\x80;UO!Dh\xc6\x8ex\xb9d\x89<\x0f\x05P\x83\x14>\xf7,\xb6{8C\xf5 \xb9\xf1\xee\xcc<5})\x80\xaa\x84\xa8\xdc\x85-\xe3\xb8T\xf5 ^.iv\x1e\x15\xa1_:\x8fD\x01\x14\xe00\xd6\xd4\xe2F\xd5S\x88\xc07cG\xbc\xbc]ROE\x01J\x9d\x11\\\xfe"\x1eU\xff\xe5G\xd8\xc3\xed\xd9\x89\xdeR{,\nP\xd2\x14\xb0x\x17\xb6\x18\xf8\xbc\xeaA\x1c;au7\x95\xc2\xef\x9e\x14@\x19\x04*\xfe\x82\xdbO\xe0Z\xe5\x83\x04^\xa2\xfdP\xe8\x16K\xf0\xd9(@\xe9\xd2\x8d+_\xc7\x03\xea7}\x91\xec=Q\xb4&J\xf3\xd9(@\x89R\xc4\xa2\x1d\xd8\x9e\xc6\xb9\xaa\x07)\x18\xa3\xa9\xfe\x93%\xfbx\x14\xa0\x14\x11\xa8\xd8\x87\x07;\xf1U\xd5\x83\x04N>\xd1q8\xf4\xbd\x92}B\nP\x8a\x9c\xc2\xb7\x0e\xe0.\xe55\x0eC\xab\xab\xc9M\x1b\xa5\xfc\x90\x14\xa0\xe40q~5\x1e\xd3\xa1\xe9;\xd9\x93\x1e\x8d\x94\xf8CR\x80\xd2\xc2\xc7\xc2\xbdxd\x18\x97\xab\x1e\xc4\xcb\xa5\xcc\xce\xa3s?\xe6\x84\x02\xa8M\x1d\xfe\xfd\x10n\xd6\xe1n\x8b\xd8\x11/\x97*\xfdG\xa5\x00%\xc48.\xdb\x83\x8d\x1a\\\xec\x95\x1e\x89d\'{\x94xT\nP*\x14\xb1\xa8\x1a\xdb\xe2\xb8P\xf5 n\xc64\xa3\xf5s6\xde\x99\x02h\xc2_\xf1\xa3f|G\xf5\x14\xa1\xef%\xda\x0e\x85\xbe\xab\xca\x03S\x80\x92\xa0\x1f+_\xc1C\xea\xdfm!R}\'\n\xd6\x98BOL\x01\xe6\x9f\x02\x16\xff\x16O\xe5\xb0D\xf9 \xc6Xj\xe0\xb4*/?\x14\xa0Tx\x13\xf7E\xb58\xe9kD\xebB\xaf\x14\xbfx\xa3\x00\xa5\xcbI\\{\x00w)\xff\xbb\xa7\x08\xad\xaeF\'5\xad\xdc\x93S\x80\xf9\xc4\xc0\xf2\xdd\xd8\\\xc0b\xd5\x83\xe4\xa6\xfa\xd3\xc3\x1d*>9\x05\x987<\x9c\xf1\x1a\xfe\xab\x1f+U\x0f\xe2\x172F\xa4\xb6D\xc6\x9cP\x00eh\xc4\xf7>\xc4\x0f\x95\x8f!\x84\x11\xa9\xf3\xf3iE\x1f\x9f\x02\xcc\x0f\xd3\xb8p\'\xb6j\xf0\xc5[z\xa4#7Yr\'})@I\x13\xa2\xf2w\xf8E\x02\xcbU\x0f\xe2\xa6\r3vt~\xc7;S\x00\xf5\xf8\x13~\xd2\x8co+\xaf\xb1\xef&"\xb5\x81\x9bW:\x05\x05\x98kz\xf0\x95}xP\x83\xbb-R\xfd\xa7\n\xc6\x88\xea\xdbA\x01\xe6\x94,\xce\xde\xa9\xc7xgk,\xd5\xff\xa9ZM_\n0\xcf\x08T\xec\xc7\xbav|S\xf5 \xa1W4"\xea5})\xc0<\xd3\x82\xd5\xfb\xb1.T}\xcd\x850\xbb\x9aTl\xfaR\x80\xf9$\x89e\xd5x\\\x83/\xder\xf1A{\xb0E\x9b}\xa1\x00sA\x88\xcaW\xb0~\x00W\xa8\x1e\xc4/f\x13\xed\x875x\xf5\xa7\x00sJ#\xae\xff\x00\xb7\xaa\x9eB\x84\x81\x19\xad\xf7Kl\xbc3\x05(u\x12\xb8\xa0\x1a\x8f\xfbX\xa8z\x90\xcch4;\xa1\xc6I_\nP*\x04XP\x8d\xc7\xe2\xb8@\xf5 n\xc6\xb4\xba\x9a\x14\xfd\xe2\x8d\x02\xcc\x0f\x02\x15\xef\xe1\x8eF\\\xafz\x90\xd0w\x8d\x8e\x1a\xbf\x98\xd5o\x8f(\xc0,\xd2\x87/\xeb0\xdeY\x08{\xb0%\x9f\x18\xd6r\x8f(\xc0l\x91\xc5\xd9\xbb\xb1\xd9\xc22\xd5\x83\x14\x93\x93\xc9\x9ef]\xb7\x89\x02\xcc\n!*\xdf\xc5\xda\x16\xacV>\x88\xef%\xdaU\x1asB\x01J\x82\x18V\xbd\x8d{\x94o\xfa\x02VW\x93c\xc75\xde)\n0\xf3\xe4\xb1\xe4\xff\xf0\xab\x02\xceR=Hn\xaa\xdf\x1e\xd2\xa7\xe9K\x01\xe6\x82\x10\x95/`\x93\x06\xe3\x9d\xfdB\xda\x88\xd6\x97\xfexg\nPZ4i\xd3\xf4\xedl\xf4\xb2\x96\xf6\xfbE\x01f\x92)\\\xb4[\x87;}\x91\x19\xeb\xcc\x8ew\x95\xc3\x96Q\x80\x19\xc3E\xd5\x1el\x9c\xc0\xa5\xca\x07\xc9ZV\xe7Q\xfd\x9a\xbe\x14`v\xf9\x18\xb7\xd4\xe3\x06\r\xee\xb6\xd0\xb5\xe9K\x01f\x91\x01\xac\xdc\x8bG\x02\xf5\xbfxK\xf5\x9f\xca\xc7\x87\xcag\xe3(\xc0\x0cP\xc0Y\xcfc[\x12\x9fS=\x88\x93\x9aJ\xf6\x1c/\xab\xbd\xa3\x003\xc0\x01\xac=\x85\xabUO\x11z\xc5D\xfba\x8d\x9b\xbe\x14`V\xe8\xc4\xd7\xde\xc0\xfd\xca\xc7\x10\xc2\xeai.\xa6\xa6\xcam\xfb(\xc0?D\x0eK\x9e\xc1SE,R=H>>\x94\x1ej\xd3\xe9\xac#\x05\x98uBT\xbe\x8c\r}\xf8\x92\xeaA\xfe6\xde\xb9\xdc^~(\xc0?J#\xbe\xf7>n\xd5\xe0wO\xab\xab\xd1-\x83\xa6/\x05\x98I&q\xf1K\xd8\xe0\xe0L\xd5\x83d\xc7\xbb3c\xb1\xb2\xddG\n\xf0YpQ\xf5\n\x1e\x1a\xc1\x17T\x0f\xe2\xe5m3Z/B\x85\xc7;S\x80y\xa0\x167\xd5`\x8d\xea)\x84\x08\x13\xed\x87}\'W\xce[I\x01\xa4\x19\xc3\x8a\x9d\xd8\xa2\xfcI_\xc0\xee?\x95\x8f\x0f\x96\xf9nR\x009\\T=\x8d_\xa6\xd5\x1f\xef\\LN&{\x9b\xcb\xf0wO\n\xf0\x0f\xb1\x1f\xebZ\xf1/\xaa\xa7\x08\xdc\xa2\x11\xad\x0b\\\x1d\xc6;S\x80\xb9#\x82\xaf\xbf\x8d{5\xb8\xd37\xd5\x7f\xa2hMpC)\x80\x04i,\xdd\x89\xad\x19\x9c\xa3z\x90\x821b\x0f\xb4\xf0\xe5\x87\x02H\x10\xa2\xf2\r\xdc\xd7\x89\xaf\xaa\x1e$p\xf3\x89\xf6\x9a\xf2l\xfaR\x80\xcf\xceq|\xe7O\xf8\x89\x06\x17{\x19\x91\xfar8\xe9K\x01f\x928.\xd8\x8d-:4}\'{2\xa3\xe5\xdb\xf4\xa5\x00\x9f\x85\x10\x95{\xb0q\x14+T\x0f\xe2\xe5RF\xa4\x0e\xe0\xab?\x05\x90\xe10n\xd6\xa1\xe9\x1b\xf8F\xb4\xce/d\xb8\xa1\x14@\x82\t\\\xb2\x1b\x9b5\x98p\x98\x1en\xcfO\rpC)\x80\x04\x0e\xce|\x06O\xe90\xde95eu\x1f\x13\xa2|\xbfx\xa3\x00\xd2\x08T\xbc\x8b\xb5-\xb8J\xf5 \xa1W4#u\x81[\xe0\x9eR\x00\t\xa2X\xf5\x0e\xee\xd1\xe0n\x8bd\xdf\xa7\x05s\x8c\x1bJ\x01$H\xe3\xdc\xdd\xd8b\xab\xff\xc5[\xc1\x1cK\xf5\x9f\xe4\x86R\x00\tBT\xbe\x8d{\xa3X\xa5|\x10\xcfI\xb4\x1d\xd4~\xbc3\x05\x98aN\xe3\xaa\xfdX\xa7C\xd37Z_\xb6\'})\xc0g\xc4\xc6\xd2\xdf\xe0W\x1a\x8cw\xceNteF\xa3\xdcP\n A\x80\x05;\xb1u\n\x17\xa9\x1e\xc4\xcb&\xcdX\xb9\x8cw\xa6\x003F\r\xd6\xd4\xe2&\xd5S\x88\xc03;\x8fzy\x9b\x1bJ\x01$\x18\xc3\x8a\x97\xf1\x88\x06/?\xe9\xd1hn\xb2\x97\x1bJ\x01$p\xb0h\x17\xb6L\xe3B\xd5\x83\xb8\xe9\x84\xd5\xd9\xc8\xa6/\x05\x90@\xa0\xe2O\xf8\xf11\\\xa7|\x90\xc0\x8b\xb7\x1dd\xd3\x97\x02\xc8\xd1\x85+\xdf\xc0\x03\xca\xff\xee\t${y\xd2\x97\x02H\x92\xc7\x92j<\x9e\xc6\xb9\xaa\x07)\x18\xa3l\xfaR\x00i\xde\xc0}\x1a4}\x03\'oDjC\xdfcAS\x00\tZ\xb1z?\xd6)\x1fC\x08\xab\xfb\x98c\xc7Y\xcd\x14@\x02\x0b\xcb\x9e\xc6S.\xaaT\x0f\x92\x9d\xe8N\x0f\xb7\xb3\x94)\x80\x04>\x16\xbe\x8c\rcZ\x9c\xf45\xcb\xe6N_\n0c\xd4\xe1\xc6C\xb8Y\x83\xbb-\xcc\xd8\x11/\x97b\x1dS\x00\tF\xb1b/\x1e\xd6\xe0\xe5\'3\x12\xc9N\xf6\xb0\x88)\x80\x04.\xaa\xf6`\xd3$.V=\x88\x97M\x1a\xb1\x06N8\xa4\x00r\xfc\x15?:\x8a\xef\xa9\x9eB\x04~\xbc\xf5\xa3\xd0sX\xc1\x14@\x82~\xac|\t\x1b48\xec\x92\xec\xfd\xa4`\x8d\xb3|)\x80\x04\x05,~\x06O\xe5q\x96\xf2A\xcc\xb1\xd4\xc0)\xbe\xfcP\x00\t\x04*\xde\xc4}1=\x9a\xbe\xd1z\xbe\xfcP\x009N\xe3\xea?\xe0N\r\xee\xb6H\xf64;\xa9i\x16.\x05\x90\xc0\xc2\xb2\x9d\xd8\x9a\xc3\x12\xd5\x83\xe4\xa7\x07\xec\xa1V\x0e\xb8\xa5\x00\x12\xf8X\xf8\n\x1e\xee\xc7J\xe5\x83\x142\x89\xf6\x1a6})\x80\x04\x02\x15G\xf0\xfd\x8fp\x8b\xf2ADhDj\xfdB\x9a%K\x01$\x98\xc2E/`\x93\xa7C\xd37\x9a\xe5I_\n E\x88\xcaj<>\xad\xfe\x98\x137c\x9a\x9dG\xf9\xbb\'\x05\x90\xe3}\xdc\xa6\xc7I_\xa3\xa36pr,V\n \xc1\x00V\xbe\x80Guh\xfa\xf6\x7f\x9aO\x0c\xb3R)\x80\x049,\xd9\x81\'\xb28[\xf5 \x05k<\xd5w\x92\xbf{R\x00\tBT\xfe\x1eww\xe0\x1b\xaa\x07\t\xdc\x82\x11\xa9c\xd3\x97\x02\xc8\xd1\x8a\xd5\xefb\xad\xf2\x17{\t\x91\xecivRS\xacQ\n \x81\x8d\xf3va\x8b\x06/?\xf9\xc4\x90=\xd8\xc2\x02\xa5\x00\x12\x04X\xb0\x17\x0f\xf5\xe2\xcb\xca\x07qr\xf1\xd6\x83l\xfaR\x009\x9a\xf0\xdd\xbf\xe0v\xd5S\x880Ht\xb0\xe9K\x01$I`\xf9sxB\x83;}3\x1c\xefL\x01d\xf1\xb1\xb0\x1a\x8f%\xb0\\\xf5 n\xda\xb0\xba\x8f\xf1\xe5\x87\x02\xc8\xf1>nm\xc2\xf5\xaa\xa7\x08}\xcf\x885\xf8\x85\x0c\xeb\x92\x02H0\x80\x95\xfb\xb0\xde\xc7B\xc5s\x88\xf4PK>>\xc8\xa2\xa4\x00\x12\xe4pv5\x1e\xb3\xb0L\xf5 \xc5\xe4\xa4\xd5}\x9c_\xbcQ\x00\tBT\x1e\xc0\xda\x16\xacV}\x1bB\xdfM\xb4\x1d\x0e}\x97\x15I\x01$\xe8\xc0\xd7\xdf\xc1\xdd\x1a\xdcmau596O\xfaR\x00\x19\xb28{\x07\xb6\xe759\xe9\xdb\xc6Z\xa4\x00r\xec\xc5\xc3\x03\x1a\x9c\xf4-f\x8dH\x9d\x08x\xb7\x05\x05\x90\xa1\x11\xd7\xbf\x87;T_}\x11\x06f\xac\xc1\xcdZ,D\n \xc1\x14.\xda\x89m\x01\x16\xa8\xbe\xfa\x99\xb1Xv\xbc\x9bUH\x01$pQ\xf5\x126L\xe0\x12\xd5\x97\xde\xcd\x98VW\x13\x9b\xbe\x14@\x8e\x83\xf8A\x03nP}\xddE\xe0\x1b\xd1z6})\x80\x1c\x83\xf8\xe2+X\xef\xe1\x0c\xd5\xd7\xdd\x1eje\xd3\x97\x02\xc8Q\xc4\xa2j<n\xe2|\xd5\x17\xdd\xb1\xe3\x1csB\x01\xa49\x80u\xa7p\xb5\xea+\x1ezN\xbc\xf5c\x11\xf8,>\n A\x0c\xab^\xc7\xfd\xca\xaf\xb7\x10\xc9\x9e\xe3l\xfaR\x00928\xe7wx\xb2\x88E\xaa/w.>h\x0f\xb5\xf1\xe5\x87\x02H P\xb1\x0f\x0fjp\xd2\xd7/f\xcdX\x03\xbfx\xa3\x00r\x1c\xc3u\x7f\xc5\x8f4\xb8\xd3\xd7\xeajt\xd3\x06k\x8e\x02H0\x85\x8bva\xab\x06/?\xd9\x89\xee\xccH\x94\x05G\x01$pQ\xf52\x1e\x19\xc3e\xaa\xaf\xb2\x97K\x99\x91z!B\x16\x1c\x05\xf8{\x11\xa88\x8c5u\xb8Q\xf5%\x16a\x90\xe8\xa8\xf19\xde\x99\x02H1\x86\xcb^\xc2F\xf5O\xfa\xb2\xe9K\x01\xe4\tQ\xf9[\xfcB\x83\x93\xbe\x8e=\x9d\xe4I_\n \x85@\xc5\xdb\xb8\xb7\x05W\xa9\xbe\xb8\xa1WL\xb4\x1f\x0e\xdc\x02\xeb\x8c\x02H\x10\xc3\xaa\xb7\xf03\xf5\xef\xb6\x08\x93}\'\x8b\xd6$\x8b\x8c\x02H`c\xe9\xf3\xd8\xa6\xc5x\xe7\x11{\xe04\xef\xb6\xa0\x00\x12\x04X\xf0&\xee\xeb\xc4\x95\xaa/k\xe0\xe4\x8ch\x1d\x9b\xbe\x14@\x8e\x93\xb8\xf6=\xdc!\x94\x1f\xd7%\xcc\xce\xa3l\xfaR\x009L|\xbe\x1a\xdb\xb4h\xfa\xf6\xa6G"\xac-\n \x81\x8f\x85\xbb\xf1\xe8\x18V\xa8\xbe\xa0^\xce6:j\xf8\xbb\'\x05\x90\xa3\x167\xd5`\x8d\xea\xab)\x02\xdf\x88\xd6\xf9\xc5,\x0b\x8b\x02H0\x8eKwc\xb3\x06w[\xd8\xc3m\xf9\xa9~V\x15\x05\x90\xc0E\xd5sxB\x87\xa6oj:\xd9\xd3\xcc/\xde(\x80\x1c\x7f\xc4OO\xe2\x1a\xd5\xd71\xf4\x1c#R\x178y\x96\x14\x05\x90 \x8aU\xaf\xe3\x01\xe5g\xbc\t\x91\xea?Y0GYO\x14@\x02\x1bKwaK\x06\xe7\xa8\xbe\x88\x05s4\xd9w\x92\xc5D\x01$\x08\xb0\xe0\xf7\xb8;\x8a\x7fV}\x05\x03\xaf\x98h;\xc41\'\x14@\x8e\x16\\u\x00w\xa9\x7f\xb7\x850cG8\xde\x99\x02\xc8\x91\xc19\xcf\xe0)\x07g\xaa\xbe|\xd9\x89^\x9e\xf4\xa5\x00r\x84\xa8|\x0eOh0\xde\xd9\xcb\xa5\x8ch\x9d\x08\xf9\xf2C\x01d\xa8\xc1\x9aZ\rN\xfa\x06\xbe\x19k\xf0\xf3i\xd6\x10\x05\x90`\x04\x97\xbf\x84\r:\xdc\xe9;\xd2\x91\x9b\xecc\x01Q\x00\t\x8aX\xf4"6N\xe3B\xd5W\xcd\xb1\x13V\xf716})\x80\x04\x02\x15\xef\xe3\xb6\xe3\xb8N\xf5%\x13\xa1ot\xd4\xb2\xe9K\x01\xe4\xe8\xc1W^\xc5z\r.\xf6J\xf6|\xc2\xa6/\x05\x90#\x87%\xcfb\xbb\x16M\xdf\xb1d\xdf\t\xd6\r\x05\x90\xe3M\xdc\x17\xc5*\xd5\x17+p\xf2FG\r\x9b\xbe\x14@\x8e\x16\\\xb5\x1f\xebT_)!B\xab\xfb\x98c\'X4\x14@\x82\x14\xce\xdb\x81\xed.\xaaT_\xa9\xdcd_z$\xc21\'\x14@\x82\x10\x95{\xb0q\x18\x97\xab\xbeL~\xde6c\r"\xf0X1\x14@\x82\x1a\xac9\x88[\xd4\xbf\xdb\xc27\xa2\r^.\xc5r\xa1\x00\x12\x8cb\xc5^<\xac\xc1\x9d\xbe\x99\x91hv\xb2\x87\xb5B\x01$pp\xe6\x1el\x9a\xc4\xc5\xaa/\x90\x9b\xb1\x8c\xce#\x1csB\x01$\xf8[\xd3\xb7\x11\xd7\xab\xbe:"\xf0\x13\xed\x87B\xb7\xc8B\xa1\x00\x12\x0c\xe3\xf2\xbdxX\x831\'<\xe9K\x01\xa4qp\xe6\xff\xe2\xbf5\x18\xef\\0\xc7\x92\xbd\'\xf8\xf2C\x01$\x10\xa8x\x1d\x0ft\xe91\xde9R\xcb\xf1\xce\x14@\x8e\xd3\xb8\xea]\xacU\xffw\xcf0\xd9\xf3\x89\x93\x9af}P\x00\t,,\xdb\x85-y\x9c\xa5\xfa\xa2\xe4\xa7\x07\xec\xe16\x16\x07\x05\x90 \xc0\x82}x\xb0\x1f_R}E\xfcb\xd6\x88\xd4\xf1\x8b7\n \xc7Q\xfc\xdb\x07\xb8U\xfd\x8b\xbd\x84\xd1Q\xe3\xe5S\xac\x0c\n \xc1$.\xde\x89\xad\x1a4}\xd3\xa3\xd1\xec\x04\x9b\xbe\x14@\x06\x1f\x0bwb[\x1c\x17\xa8\xbe\x16n\xda0cGX\x13\x14@\x8e\x0fp\xab\x06M\xdf\xd0w\x8dh]\xe0\xe4X\x13\x14@\x82A|\xf1elP\x7f\xc2!\xec\xc1\x96|b\x84\x05A\x01$(b\xf1\x0e<i\xe3\\\xd5W\xa1h\x8d\'{O\x80cN(\xc0\xdfO\x88\xca\xb7po\x1b\xbe\xa9\xfa\x12\x04n!\xd1Q\x1bz\xfc\xe2\x8d\x02\xc8\xd0\x8a\xd5\x07\xd4o\xfaB\x88d\xcfq\'5\xc5R\xa0\x00\x12XX\xb6\x1b\x9bs\xea\x7f\xf1\x96\x8b\x0f\xda\x83\xad\xac\x03\n A\x80\x05\xaf\xe3\x81\x1e|E\xf5\xf0\x81\x937\xdakD\x18\xb0\x0e(\x80\x04\x9f\xe0_\xff\x8c\x1f+\x1f]\x08#R\xc7\xa6/\x05\x90\xc3\xc2\xf9\xbf\xc1\xaf\xd4\x1f\xef\x8c\xf4HGv\xa2\x8b\x15@\x01$\xf0p\xc6\x0e-\xee\xf4u\xd3\x86\xd5uL\x84\xfc\xdd\x93\x02\xc8\xf0!~\xd8\xa4G\xd37\xd6\xe0\x173\xdc~"!@\x1f\xbe\xb4\x0f\x0f*\xff\xf2#\x84=\xd4\x9a\x8f\x0fq\xef\x89\x84\x00y\x9c\xb5\x1b\x9bM\x9c\xafz`\'5\x9d\xecif\xd3\x97H\x08 P\xf1.\xd6\x9e\xc2\xb7TO\x1b\xfa^\xbc\xed\xe3\xd0s\xb8\xf1DB\x80v|\xe3-\xfcL\x83;}\xad\xaeF\xc7\x8es\xd7\x89\x84\x00i\x9c\xfb\x1c\x9e\xd0\xe2\xa4\xef\xa0=\xd4\xca-\'r\x02\xbc\x8a\xf5}\x9a\x9c\xf4\xad\xe7I_"\'\xc01|\xf7/\xb8]\xf5\x90"\x0c\xcd\xce\xa3n\xd6\xe4~\x13\t\x01\x12X^\x8d\xc748\xe9\x9b\x1d\xef\xcc\x8eur\xb3\x89\x84\x00\x1e\xaava\xcb\x04.Q=\xa1\x9b5\xcd\xd8\x11~\xf1F$\x04\x10\xa8\xf8\x08?8\x82\xef\xab\x1eO\x04\x9e\x19\xa9\xf7\x8bY\xee4\x91\x10`\x10W\xbc\x86\x9fk\xf0\xc5\x9b=\xd8\x96\x9b\x1e\xe46\x13\t\x01\x8aX\xb4\x0b\x9b\x13X\xaez6\'\x9d\xb0\xba\x9bx\xad\x1d\x91\x12\xa0\xe2\x0f\xb8\xf3S\\\xa3z\xb00\xf0\x12\xad\x1fs\xbc3\x91\x13\xa0\x0bW\xbe\x8a\xf5\x1a\x9c\xf4\xb5\xba\x9a\x8a\xc9In0\x91\x10 \x8b\xb3\x9f\xc6/5\xb8\xd37\x1f\x1fL\xb3\xe9K\xa4\x04\x08Q\xa9I\xd3\xb7\x901b\r\xa1\xcf;}\x89\x8c\x00\xc7q\xdd\xfb\xb8M\xfd\xbb-\x02\xab\xfb\x98\x9b6\xb8\xb5DB\x80\x04\x96\xbf\x88M\x05,V=On\xb273\x1a\xe1\xbe\x12\t\x01<\x9c\xb1\x07\x1b\x87q\xb9\xeaa\xbc\xbc\x9d\xe8\xa8\xe5I_"!\x80@\xc5!\xdc\\\x835\xaa\'\x11a\x90h?\xc4\xf1\xceDN\x80Q\xacx\t\x1b\x03,P=\x89=\xd4\x9a\x9f\x1e\xe2\x8e\x129\x01v`\xbb\x06cN\x9c\xd4T\xb2\xfb8\x9b\xbeDZ\x80\xd3\xb8Z\xf5\x0c\xa1\xe7\x18\xd1\xfa\xc0-p;\x89\xb4\x00:\x8cw\xee;Q0\xc6\xb8\x97\xe4\xb3\x08\xa0z\x80|b\xd8\x1e8\xc5\x97\x1fR\x8e\x02\xf8\xc5\x9c\x11\xadc\xd3\x97\x94\xa5\x00BX]\x8dl\xfa\x922\x15 ;\xd9\x93\x19a\xd3\x97\x94\xa5\x00~!ct\xd4\nN8$e(\x80\x08\x83D\xfba\x9e\xf4%\xe5)\x80\xb0\x87\xda\xf2\xd3\x03\xdc<R\x8e\x02\xfcm\xbc3_~H9\n\x10z\x8e\x11m\xe0\x17o\xa4,\x05\x10"5p\xaa`\x8er\xdbH9\nP\xb0\xc6\x92\xbd\x9f@\xb0\xe9K\xcaO\x80\xd0+\xc6[\x0fr\xbc3)K\x01\x840bG\xbc\xac\xc5\r#\xe5(\x00\x9b\xbe\xa4|\x05\xf0\xf2\xb6\x19\xe5xgR\x96\x02\x88\xd07\xa3\r^>\xc5\xad"e(\x80H\x0fGr\x93\xbd\xdc\'R\x8e\x028v\xc2\xeanb\xd3\x97\x94\xa3\x00\xa1\xef\x1a\x91\xda\xc0\xc9s\x93H9\n`\xf7\x9f*\x18l\xfa\x92\xb2\x14\xa0\x98\x9c\xb4z\x9b\xb9=d\xb6\xf9\x7f\x02\xcf\xd8\x17/\xff\x92Y\x00\x00\x00\x00IEND\xaeB`\x82'

        _, ICON_PATH = mkstemp()
        with open(ICON_PATH, 'wb') as icon_file:
            icon_file.write(icodat)

        return ICON_PATH

if __name__ == '__main__':
    main()
